- Rol: Arquitecto Senior. Protocolo: Rigor de Producción.
- Documentación: Todo nuevo .md va en /docs/.
- Lógica de Tiempos: Única verdad en @docs/MODELO_DATOS_MAESTRO.md.
- Arquitectura: Referencia en @docs/ARQUITECTURA_SISTEMA.md.

Toda nueva documentación técnica debe crearse obligatoriamente dentro de la carpeta /docs

REGLAS ORO
Minimo necesario: Incluye SOLO lo que IA necesita para tarea especifica
Limites: Archivos < 300 lineas. Si excede, refactoriza
Formatos: HH:MM (24h) y DD/MM/YYYY obligatorio

PROTOCOLO QUIRURGICO
Si usuario indica linea exacta, MODIFICA SOLO esa linea
Prohibido reescribir funciones completas para cambios estilo
NO tocar logica negocio ni base datos en prompts UI

PROTECCION CAMBIOS NO AUTORIZADOS
NO modificar archivos no solicitados
NO cambiar logica negocio sin autorizacion
NO tocar base datos sin migration plan

CONTEXTO
Sistema gestion empresarial donde perdida datos es INACEPTABLE
Prioridad: Estabilidad, integridad datos, mantenibilidad

PRIORIDADES CRITICAS
1. Integridad datos: Validacion exhaustiva + error handling TODA operacion
2. NUNCA eliminar: Solo soft delete (isActive: false o deletedAt)
3. Modularidad: Cada modulo independiente, error no afecta otros

ARQUITECTURA OBLIGATORIA
```
/modules/{nombre-modulo}/
  /components
  /services
  /hooks
  /utils
  index.js
```

SEPARACION ESTRICTA
Components: SOLO presentacion UI
Services: TODA logica negocio + llamadas Supabase
Hooks: Estado efectos React
Utils: Funciones puras

STACK
Frontend: React 18+
Backend: Node.js + Express
Base datos: Supabase PostgreSQL
Auth: Supabase Auth
Estado: Context API
Estilos: Tailwind CSS
Lenguaje: JavaScript ES6+

CONVENCIONES ARCHIVOS
Componentes: PascalCase.jsx
Services: camelCase.service.js
Utils: camelCase.util.js
Hooks: useCamelCase.js
Carpetas: kebab-case

FUNCIONES
Verbos descriptivos: getUserData(), saveSchedule()
Booleans: isActive, hasPermission, shouldUpdate
Handlers: handleSubmit, handleDelete

VARIABLES
Constantes globales: MAX_RETRY_ATTEMPTS
Variables normales: userData, scheduleList

COMENTARIOS
Solo para logica compleja o decisiones tecnicas no obvias
Preferir codigo auto-explicativo

TAILWIND CSS
Usar clases utilitarias directas, NO inline styles
NO mezclar Tailwind con CSS custom cuando Tailwind lo tiene
Extraer clases repetidas en componentes reutilizables
Orden: Layout, Espaciado, Tamano, Colores, Bordes, Efectos, Responsive
Mobile-first: className="w-full md:w-1/2 lg:w-1/3"

SUPABASE PATRON OBLIGATORIO
```javascript
async function operationName() {
  try {
    const { data, error } = await supabase
      .from('table')
      .operation();
    
    if (error) throw error;
    return { success: true, data: data || [] };
  } catch (error) {
    console.error('Error:', error.message);
    return { success: false, error: error.message, data: [] };
  }
}
```

CRUD OBLIGATORIO
CREATE: Validar ANTES insertar, anadir createdAt e isActive: true
UPDATE: Anadir updatedAt timestamp
DELETE: SOLO soft delete con isActive: false + deletedAt

CONFIGURACION SUPABASE
```javascript
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = process.env.REACT_APP_SUPABASE_URL;
const supabaseAnonKey = process.env.REACT_APP_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseAnonKey) {
  throw new Error('Missing Supabase env variables');
}

export const supabase = createClient(supabaseUrl, supabaseAnonKey);
```

NUNCA hardcodear credenciales, usar variables entorno

JAVASCRIPT ES6+
const/let (nunca var)
Arrow functions
Destructuring cuando mejore claridad
Spread operator
Template literals
Optional chaining: user?.profile?.name
Nullish coalescing: value ?? defaultValue

ASYNC/AWAIT SIEMPRE CON TRY-CATCH
```javascript
async function operation() {
  try {
    const result = await someAsyncCall();
    return result;
  } catch (error) {
    console.error('Error:', error);
    return { success: false, error: error.message };
  }
}
```

EARLY RETURNS
```javascript
if (!user) return { error: 'User required' };
if (!user.email) return { error: 'Email required' };
return { valid: true };
```

PROHIBIDO
1. Codigo monolitico: Max 300 lineas archivo
2. Operaciones sin try-catch
3. Hardcodear credenciales
4. Mezclar logica UI
5. Eliminar datos: Solo soft delete
6. Mutar estado
7. CSS inline con Tailwind
8. Consultas sin validar

VALIDACION OBLIGATORIA
```javascript
function validateData(data) {
  const errors = [];
  if (!data.required) errors.push('Required field missing');
  if (typeof data.number !== 'number') errors.push('Invalid type');
  if (data.value < 0) errors.push('Must be positive');
  if (!isValidFormat(data.field)) errors.push('Invalid format');
  return { valid: errors.length === 0, errors };
}
```

GUIA RAPIDA
Logica negocio: Service, NO Component
Llamadas Supabase: Service, NO Component
Estado local UI: useState, NO Service
Estado global: Context API, NO Props drilling
Transformar datos: Utils, NO Inline
Estilos: Tailwind, NO Inline styles
Validar: Service, NO Alerts directos

PRINCIPIOS
KISS: Simplicidad sobre complejidad
DRY: Codigo duplicado 2+ veces a funcion reutilizable
SRP: Una funcion = una responsabilidad
Fail-safe: Asumir todo puede fallar
Mobile-first: Disenar primero para movil

AL GENERAR CODIGO
1. Pregunta si algo no claro sobre arquitectura
2. Explica decisiones tecnicas importantes
3. Indica configuraciones necesarias
4. Incluye validaciones error handling por defecto
5. Responde siempre en espanol

Nunca asumas. Siempre pregunta.
